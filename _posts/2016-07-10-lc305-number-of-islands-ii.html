---
layout: post
title: LC305 Number of Islands II
date: 2016-07-10 00:50:53.000000000 -04:00
type: post
published: true
status: publish
categories: []
tags:
- LeetCode
meta:
  _rest_api_published: '1'
  _rest_api_client_id: '-1'
  _publicize_job_id: '24635071073'
author:
  login: cowboybebop98
  email: xiongm@gmail.com
  display_name: cowboybebop98
  first_name: ''
  last_name: ''
---
<h1>Problem</h1>
<p>A 2d grid map of <code>m</code> rows and <code>n</code> columns is initially filled with water. We may perform an <i>addLand</i> operation which turns the water at position (row, col) into a land. Given a list of positions to operate, <b>count the number of islands after each <i>addLand</i> operation</b>. An island is surrounded by water and is formed by connecting adjacent lands horizontally or vertically. You may assume all four edges of the grid are all surrounded by water.</p>
<p><b>Example:</b></p>
<p>Given <code>m = 3, n = 3</code>, <code>positions = [[0,0], [0,1], [1,2], [2,1]]</code>.<br />
Initially, the 2d grid <code>grid</code> is filled with water. (Assume 0 represents water and 1 represents land).</p>
<pre>0 0 0
0 0 0
0 0 0
</pre>
<p>Operation #1: addLand(0, 0) turns the water at grid[0][0] into a land.</p>
<pre>1 0 0
0 0 0   Number of islands = 1
0 0 0
</pre>
<p>Operation #2: addLand(0, 1) turns the water at grid[0][1] into a land.</p>
<pre>1 1 0
0 0 0   Number of islands = 1
0 0 0
</pre>
<p>Operation #3: addLand(1, 2) turns the water at grid[1][2] into a land.</p>
<pre>1 1 0
0 0 1   Number of islands = 2
0 0 0
</pre>
<p>Operation #4: addLand(2, 1) turns the water at grid[2][1] into a land.</p>
<pre>1 1 0
0 0 1   Number of islands = 3
0 1 0
</pre>
<p>We return the result as an array: <code>[1, 1, 2, 3]</code></p>
<h1>Analysis</h1>
<p>这题要用union find</p>
<h1>Solution</h1>
<p>[code language="cpp"]<br />
class Solution {<br />
public:<br />
    vector&amp;amp;lt;int&amp;amp;gt; table;<br />
    vector&amp;amp;lt;pair&amp;amp;lt;int,int&amp;amp;gt;&amp;amp;gt; deltas = {{-1,0},{1,0}, {0,-1}, {0,1}};<br />
    vector&amp;amp;lt;int&amp;amp;gt; numIslands2(int m, int n, vector&amp;amp;lt;pair&amp;amp;lt;int, int&amp;amp;gt;&amp;amp;gt;&amp;amp;amp; positions) {<br />
      table.assign(m*n, -1);<br />
      vector&amp;amp;lt;int&amp;amp;gt; res;</p>
<p>      for (const auto &amp;amp;amp;i : positions)<br />
      {<br />
         int index = i.first * n + i.second;</p>
<p>         table[index] = index; // creating an island</p>
<p>         int count = 1;</p>
<p>         unordered_set&amp;amp;lt;int&amp;amp;gt; unioned_islands;<br />
         for (auto &amp;amp;amp;j : deltas)<br />
         {<br />
             int x = i.first + j.first;<br />
             int y = i.second + j.second;<br />
             int new_index = x * n + y;</p>
<p>             if (x &amp;amp;lt; 0 || x &amp;amp;gt;= m || y &amp;amp;lt; 0 || y &amp;amp;gt;= n || table[new_index] == -1) continue;<br />
             unioned_islands.insert(find(new_index)); // track the unique root this union adds<br />
             unions(index, new_index);</p>
<p>         }<br />
         count -= unioned_islands.size(); // </p>
<p>         res.push_back(res.size() ? res.back() + count : count);<br />
      }<br />
      return res;<br />
    }</p>
<p>    int find(int key)<br />
    {<br />
       while(key != table[key]) key = table[key];<br />
       return key;<br />
    }</p>
<p>    void unions(int x, int y)<br />
    {<br />
       int p = find(x), q = find(y);<br />
       table[p] = q;<br />
    }<br />
};<br />
[/code]</p>
